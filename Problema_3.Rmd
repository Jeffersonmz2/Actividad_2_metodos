---
title: 'Problema 3: Teorema del límite central'
author: "Ricardo_Vargas_M"
date: "2025-09-15"
output: html_document
---

## Problema 3:Teorema del limite central

En una planta de fabricación de componentes electrónicos, se modela el tiempo (meses) de funcionamiento continuo de una máquina antes de necesitar mantenimiento mediante una distribución Exponencial. El análisis ha determinado que el tiempo hasta el primer mantenimiento sigue una distribución Exponencial con parámetro λ=0.16

La distribución exponencial definida por:
$$
X \sim \text{Exp}(\lambda)
$$

### a. Cálculo de la media y varianza de la población:

Para la distribución exponencial su media:
$$
\mathbb{E}[X] = \frac{1}{\lambda}
$$
la varianza: 
$$
\text{Var}(X) = \frac{1}{\lambda^{2}}
$$
Realizando el calculo reemplazando el valor de $\lambda$ obtenemos:


```{r ecuaciones ,include=TRUE, echo=FALSE,results='hold', message=FALSE, warning=FALSE}
library(tibble)
library(tidyverse)

lambda <- 0.16
mu <- 1/lambda
varX <- 1/(lambda^2)
tibble(media_poblacional = mu, var_poblacional = varX)
```
Una maquina puede funcionar alrededor de 6.25 meses antes del mantenimiento.El valor de la varianza es bastante alto por lo tanto habra maquinas que fallen mucho antes o tal vez mucho despues del valor que estamos estimando

### b. Gráfico de la curva de densidad:

```{r Grafica 1,include=TRUE, echo=FALSE,results='hold', message=FALSE, warning=FALSE,include=TRUE, echo=FALSE,results='hold', message=FALSE, warning=FALSE}

# Datos para graficar
x <- seq(0, 40, length.out=1000)
y <- dexp(x, rate=lambda)


# Gráfico de densidad
plot(x, y, type="l", 
     col="blue", lwd=2,
     main="Densidad Exponencial (λ = 0.16)",
     xlab="Tiempo hasta mantenimiento (meses)",
     ylab="Densidad")

# Línea vertical en la media
abline(v=mu, col="red", lty=2, lwd=2)

# Leyenda
legend("topright", 
       legend=c(paste("Media =", round(mu,2),"meses")),
       col="red", lty=2, lwd=2, bty="n")



```


La curva de densidad exponencial y su media se puede ver en la grafica anterior, por si sola esta gráfica nos permite ver la variación existente en cuanto a las maquinas y su tiempo de mantenimiento. 
El parametro lambda $\lambda$ como se puede ver en la siguiente gráfica hara que la curva caiga mas rapido ( mayor fallo temprano ) o que la curva caiga lentamente de tal forma que la duracion entre mantenimientos sea mayor.

```{Grafica 2,include=TRUE, echo=FALSE,results='hold', message=FALSE, warning=FALSE,include=TRUE, echo=FALSE,results='hold', message=FALSE, warning=FALSE}



# Comparación de formas con distintos lambdas
lambda_vals <- c(0.08, 0.16, 0.32)
colores <- c("blue", "green", "orange")

# Rango de valores de x
x <- seq(0, 40, length.out=1000)

# Gráfico vacío
plot(x, dexp(x, rate=lambda_vals[1]), type="l",
     col=colores[1], lwd=2,
     xlab="Tiempo hasta mantenimiento (meses)",
     ylab="Densidad",
     main="Efecto de λ en la forma de la distribución Exponencial",
     ylim=c(0, max(dexp(x, rate=lambda_vals[3]))))

# Agregar las otras curvas
lines(x, dexp(x, rate=lambda_vals[2]), col=colores[2], lwd=2)
lines(x, dexp(x, rate=lambda_vals[3]), col=colores[3], lwd=2)

# Leyenda
legend("topright",
       legend=paste("λ =", lambda_vals),
       col=colores,
       lty=1, lwd=2, bty="n")
```



### c. Comparación de parámetros, estimadores y estimaciones: Toma 10 muestras aleatorias de tamaño n=200

```{r Lista ,include=TRUE, echo=FALSE,results='hold', message=FALSE, warning=FALSE,include=TRUE, echo=FALSE,results='hold', message=FALSE, warning=FALSE}

n <- 200 # Lista con 10 muestras (cada una de tamaño 200) 
muestras <- replicate(10, rexp(n, rate=lambda), simplify=FALSE)

library(ggplot2)
library(dplyr)

df <- data.frame(
  valor = unlist(muestras),
  muestra = rep(1:10, each=n)
)

ggplot(df, aes(x=valor)) +
  geom_histogram(aes(y=..density..), fill="skyblue", color="white", bins=20) +
  stat_function(fun = dexp, args = list(rate=lambda), color="black", size=1) +
  geom_vline(xintercept=mu, color="red", linetype="dashed", size=1) +
  facet_wrap(~muestra, ncol=5) +
  labs(x="Tiempo", y="Densidad") +
  theme_bw(base_size=12)

```


Viendo la comparación de las graficas de histogramas vs la curva vemos que puede y logra representar en una gran mayoria la "realidad" de los datos. Las muestras que presentan errores se deben al error muestral puesto que al ser diferentes las 10 muestras entre si los valores fluctuan.
Con un mayor tamaño de la muestra, las diferencias tienden a disminuir 


```{r Tablas,include=TRUE, echo=FALSE,results='hold', message=FALSE, warning=FALSE,include=TRUE, echo=FALSE,results='hold', message=FALSE, warning=FALSE}
## 3) Medias y varianzas muestrales + comparación con población
resultados <- data.frame(
  muestra        = 1:10,
  media_muestral = sapply(muestras, mean),
  var_muestral   = sapply(muestras, var)
)

resultados$dif_media <- resultados$media_muestral - mu
resultados$dif_var   <- resultados$var_muestral   - varX

print(resultados)

## 4) Resumen global de las 10 muestras (útil para tu reporte)
resumen <- c(
  media_poblacional   = mu,
  var_poblacional     = varX,
  promedio_de_medias  = mean(resultados$media_muestral),
  promedio_de_var     = mean(resultados$var_muestral),
  sd_de_las_medias    = sd(resultados$media_muestral)    # se espera ≈ (1/lambda)/sqrt(n)
)
print(round(resumen, 4))

```
Podemos ver como las 10 muestras estan entre un rango de 6.1-6.4 todas muy cercanas al 6.25. La diferencia maxima es de alrededor de 0.15. De la misma forma la varianza esta en un rango de 31-42 y su diferencia es de alrededor 2.7.

La desviación estandar de las medias 0.27 indica que tanta variación hay entre las medias de la muestra al tener tan pocas muestras el valor es bajo, seguramente si se aumentamos las muestras o su población este valor tambien aumentaria.

 

### d. Aplicación del Teorema del Límite Central para n=200
:

Genera 100 muestras de tamaño n=200
 de la población Exponencial.

Calcula la media muestral de cada muestra y elabora un histograma de las 100 medias muestrales.

Obtén el promedio y la varianza de estas 100 medias muestrales.

Aplica un test de normalidad (α=0.05
) a las 100 medias muestrales e interpreta los resultados.

Explica cómo se evidencia el Teorema del Límite Central en el comportamiento de las medias muestrales, considerando:

Distribución de las medias muestrales.

Comparación de la media y varianza muestral con las esperadas.

### e. Aplicación del Teorema del Límite Central variando n:

Repite el análisis anterior extrayendo 100 muestras de cada uno de los siguientes tamaños: n=
 5, 10, 80, 200, 500 y 2,000.

Para cada tamaño de muestra n
:

Calcula el promedio y la varianza de las 100 medias muestrales.

Elabora un histograma de las 100 medias muestrales.

Aplica un test de normalidad (α=0.05
) y discute los resultados.

Concluye sobre la relación entre el tamaño muestral y la validez del Teorema del Límite Central, analizando:

Comportamiento de la distribución de las medias muestrales.

Convergencia de la media y varianza muestral hacia los valores teóricos.
