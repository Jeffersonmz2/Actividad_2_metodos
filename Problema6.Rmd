---
title: "Problema6"
author: "Jefferson Martinez"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
set.seed(123)

library(dplyr)
source("script_prueba_problema6.R")
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)

```
Pregunta 1: ¿Existe una diferencia significativa en los ingresos entre clientes que aceptan ofertas de campañas anteriores y aquellos que no?
Para responder esta pregunta, realizaremos una prueba de hipótesis para comparar las medias de ingresos (Income) entre dos grupos: clientes que aceptaron al menos una oferta en campañas anteriores (AcceptedCmpOverall > 0) y aquellos que no (AcceptedCmpOverall == 0). Utilizaremos una prueba t de Student de dos muestras, asumiendo independencia entre grupos.
Hipótesis

H₀: No hay diferencia en los ingresos medios entre los grupos (μ₁ = μ₂).


H₁: Hay diferencia en los ingresos medios entre los grupos (μ₁ ≠ μ₂).
Nivel de significancia: α = 0.05.


```{hipotesis_1, echo=FALSE,results='asis', warning = FALSE}
shapiro_si <- shapiro.test(group_si)
shapiro_no <- shapiro.test(group_no)
print(shapiro_si)  # Si p-value < 0.05, no normal
print(shapiro_no)

# Si ambos son normales, verificar varianzas
if (shapiro_si$p.value > 0.05 & shapiro_no$p.value > 0.05) {
  var_test <- var.test(group_si, group_no)
  print(var_test)  # Si p-value > 0.05, varianzas iguales
  
  var_equal <- var_test$p.value > 0.05
} else {
  var_equal <- FALSE  # Si no normal, usamos Welch por defecto o prueba no paramétrica
  message("Datos no normales: Considerar prueba de Wilcoxon.")
}

# Prueba de hipótesis
if (shapiro_si$p.value > 0.05 & shapiro_no$p.value > 0.05) {
  t_result <- t.test(group_si, group_no, var.equal = var_equal, conf.level = 0.95)
} else {
  t_result <- wilcox.test(group_si, group_no, conf.int = TRUE, conf.level = 0.95)
}
print(t_result)

# Intervalo de confianza para la diferencia de medias (o mediana si no paramétrico)
ci_diff <- t_result$conf.int
print(paste("Intervalo de confianza al 95% para la diferencia: [", ci_diff[1], ", ", ci_diff[2], "]"))

```


